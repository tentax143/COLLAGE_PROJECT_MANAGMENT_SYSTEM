<!DOCTYPE html>
{% load static %}
<html>
<head>
    <title>RIT PROJECT MANAGEMENT</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.5.0/font/bootstrap-icons.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <style>
        body {
            min-height: 100vh;
            overflow-x: hidden;
            font-family: Arial, Helvetica, sans-serif;
            background-color: #f8f9fa;
        }
        .table-responsive {
            max-height: 400px; /* Adjust height as needed */
            overflow-y: auto;
        }

        .vertical-nav {
            width: 27rem;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.1);
            background-color: #fff;
            z-index: 1000;
        }

        .page-content {
            margin-left: 23rem;
            transition: all 0.4s;
            padding: 20px;
            min-height: 100vh;
        }

        .table-container {
            margin-top: 20px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #00407b;
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        @media (max-width: 768px) {
            .vertical-nav {
                margin-left: -23rem;
            }
            .vertical-nav.active {
                margin-left: 0;
            }
            .page-content {
                width: 100%;
                margin-left: 0;
            }
            .page-content.active {
                margin-left: 23rem;
            }
        }

        #sidebarCollapse {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
        }
        .chart-container {
            width: 200px;
            height: 200px;
            margin: auto;
        }
        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
            background-color: #00407b;
            text-align: center;
            padding: 10px 0;
            border-top: 1px solid #dee2e6;
            z-index: 1000;
        }
        .footer p {
            color: white;
            margin: 0;
        }
    </style>
</head>
<body>

    <div class="vertical-nav" id="sidebar">
        <div class="py-4 px-3 mb-4 bg-light border-bottom">
            <div class="media d-flex align-items-center">
                <div class="media-body">
                    <img src="{% static 'images/image.png' %}" alt="RIT Logo" width="80" height="80" class="mr-3 rounded-bottom img-thumbnail shadow-sm">
                    <h4 class="m-0">RIT</h4>
                    <p class="font-weight-normal text-muted mb-0">Ramco Institute of Technology</p>
                </div>
            </div>
        </div>
        <div class="border-bottom mb-2">
            <div class="card-body text-center">
                <i class="bi bi-person-circle" style="font-size: 2rem;"></i>
                <h5 class="card-title">{{ name }}</h5>
                <p class="card-text">{{ department }}</p>
                <p class="card-text">{{ role }}</p>
            </div>
        </div>

    {% if role == 'HOD' %}
        <ul class="nav flex-column bg-white mb-0">
            <li class="nav-item">
                <a href="{% url 'hod_dashbord' %}" class="nav-link bg-info text-white">
                    <i class="fa fa-chart-line mr-3 text-primary fa-fw"></i>
                    Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a href="#marksSubMenu" data-toggle="collapse" aria-expanded="false" class="nav-link text-dark dropdown-toggle">
                    <i class="fa fa-plus S mr-3 text-primary fa-fw"></i>
                    Allocate Committee Members
                </a>
                <ul class="collapse list-unstyled ml-4" id="marksSubMenu">
                    <li class="nav-item">
                        <a href="{% url 'review1' %}" class="nav-link text-dark">
                            <i class="fa fa-circle mr-3 text-primary fa-fw"></i>
                            Review 1
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="{% url 'review2' %}" class="nav-link text-dark">
                            <i class="fa fa-circle mr-3 text-primary fa-fw"></i>
                            Review 2
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="{% url 'review3' %}" class="nav-link text-dark">
                            <i class="fa fa-circle mr-3 text-primary fa-fw"></i>
                            Review 3
                        </a>
                    </li>
                </ul>
            <li class="nav-item">
                <a href="{% url 'guide_alocation' %}" class="nav-link text-dark">
                    <i class="fa fa-plus S mr-3 text-primary fa-fw"></i>
                    Allocate Guide
                </a>
            </li>
        </ul>  
        <li class="nav-item">
            <a href="#marksSubMenu2" data-toggle="collapse" aria-expanded="false" class="nav-link text-dark dropdown-toggle">
                <i class="fa fa-plus S mr-3 text-primary fa-fw"></i>
                Review Mark Entry
            </a>
            <ul class="collapse list-unstyled ml-4" id="marksSubMenu2">
                <li class="nav-item">
                    <a href="{% url 'review1_markentry' %}" class="nav-link text-dark">
                        <i class="fa fa-circle mr-3 text-primary fa-fw"></i>
                        Review 1
                    </a>
                </li>
                <li class="nav-item">
                    <a href="{% url 'review2_markentry' %}" class="nav-link text-dark">
                        <i class="fa fa-circle mr-3 text-primary fa-fw"></i>
                        Review 2
                    </a>
                </li>
                <li class="nav-item">
                    <a href="{% url 'review3_markentry' %}" class="nav-link text-dark">
                        <i class="fa fa-circle mr-3 text-primary fa-fw"></i>
                        Review 3
                    </a>
                </li>
            </ul>
        </li>
        
        <li class="nav-item">
            <a href="{% url 'final_outcome_entry' %}" class="nav-link text-dark">
                <i class="fa fa-sign-out-alt mr-3 text-primary fa-fw"></i>
                Final Outcome Entry
            </a>
        </li>
        
        <li class="nav-item">
            <a href="{% url 'filter' %}" class="nav-link text-dark">
                <i class="fa fa-filter mr-3 text-primary fa-fw"></i>
                Filter
            </a>
        </li>
        
        <li class="nav-item">
            <a href="{% url 'criteria_analysis' %}" class="nav-link text-dark">
                <i class="fa fa-filter mr-3 text-primary fa-fw"></i>
                Criteria Analysis
            </a>
        </li>
        <li class="nav-item">
            <a href="{% url 'analysis_student_mark' %}" class="nav-link bg-info text-white">
                <i class="fa fa-chart-bar mr-3 text-primary fa-fw"></i>
                Student Mark Analysis
            </a>
        </li>
        <li class="nav-item">
            <a href="{% url 'criteria_entry' %}" class="nav-link text-dark">
                <i class="fa fa-list-alt mr-3 text-primary fa-fw"></i>
                Review Criteria
            </a>
        </li>
        <li class="nav-item">
            <a href="{% url 'downlod_review_marks' %}" class="nav-link text-dark">
                <i class="fa fa-download mr-3 text-primary fa-fw"></i>
                Download Review Marks
            </a>
        </li>
        <li class="nav-item">
            <a href="{% url 'filter' %}" class="nav-link text-dark">
                <i class="fa fa-filter mr-3 text-primary fa-fw"></i>
                Filter
            </a>
        </li>
        
        {% load static %}
            <li class="nav-item">
                <a href="{% static 'pdf/project_managment_manual.pdf' %}" class="nav-link text-dark" target="_blank">
                    <i class="fa fa-file-pdf mr-3 text-primary fa-fw"></i>
                    Manual
                </a>
            </li>

        
            <li class="nav-item">
                <a href="{% url 'home_page' %}" class="nav-link text-dark">
                    <i class="fa fa-sign-out-alt mr-3 text-primary fa-fw"></i>
                    Logout
                </a>
            </li>
        </ul>  
    </div>
    {% endif %}
    {% if role == 'Principal' %}
    <li class="nav-item">
        <a href="{% url 'principal_dashboard' %}" class="nav-link text-dark">
            <i class="fa fa-filter mr-3 text-primary fa-fw"></i>
            Dashboard
        </a>
    </li>
    <li class="nav-item">
        <a href="{% url 'criteria_analysis' %}" class="nav-link text-dark">
            <i class="fa fa-filter mr-3 text-primary fa-fw"></i>
            Criteria Analysis
        </a>
    </li>
    
    
    {% load static %}
        <li class="nav-item">
            <a href="{% static 'pdf/project_managment_manual.pdf' %}" class="nav-link text-dark" target="_blank">
                <i class="fa fa-file-pdf mr-3 text-primary fa-fw"></i>
                Manual
            </a>
        </li>

    
        <li class="nav-item">
            <a href="{% url 'home_page' %}" class="nav-link text-dark">
                <i class="fa fa-sign-out-alt mr-3 text-primary fa-fw"></i>
                Logout
            </a>
        </li>
    </ul>  
</div>
{% endif %}

<div class="page-content">
    <!-- Department Filter Section -->
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0">Department Filter</h4>
        </div>
        <div class="card-body">
            <form method="GET" class="row align-items-end">
                <div class="col-md-4">
                    <div class="form-group mb-0">
                        <label for="department" class="font-weight-bold">Select Department:</label>
                        <select name="department" id="department" class="form-control" onchange="this.form.submit()">
                            <option value="">All Departments</option>
                            {% for dept in available_departments %}
                                <option value="{{ dept }}" {% if dept == selected_department %}selected{% endif %}>
                                    {{ dept }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="col-md-2">
                    <button type="submit" class="btn btn-primary w-100">Apply Filter</button>
                </div>
            </form>
        </div>
    </div>

    <div class="container mt-5">
        <h2 class="text-center mb-4">Review Criteria Analysis</h2>
        
        <!-- Review Analysis Buttons Container -->
        <div class="card mb-4">
            <div class="card-header bg-light">
                <h4 class="mb-0">Review Analysis Options</h4>
            </div>
            <div class="card-body">
                <div class="row justify-content-center">
                    <div class="col-md-12">
                        <div class="row row-cols-2 row-cols-md-4 g-3">
                            <div class="col">
                                <button type="button" class="btn btn-primary btn-lg w-100" onclick="showContent('review1')">
                                    Review 1 Analysis
                                </button>
                            </div>
                            <div class="col">
                                <button type="button" class="btn btn-success btn-lg w-100" onclick="showContent('review2')">
                                    Review 2 Analysis
                                </button>
                            </div>
                            <div class="col">
                                <button type="button" class="btn btn-info btn-lg w-100" onclick="showContent('review3')">
                                    Review 3 Analysis
                                </button>
                            </div>
                            <div class="col">
                                <button type="button" class="btn btn-dark btn-lg w-100" onclick="showContent('allReviews')">
                                    All Reviews Analysis
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Outcome Analysis Button Container -->
        <div class="card mb-4">
            <div class="card-header bg-warning">
                <h4 class="mb-0">Project Outcome Analysis</h4>
            </div>
            <div class="card-body">
                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <button type="button" class="btn btn-warning btn-lg w-100" onclick="showContent('outcomeAnalysis')">
                            <i class="fas fa-chart-pie mr-2"></i>View Outcome Analysis
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Content Sections -->
        <div class="content-sections">
            <!-- Review 1 Container -->
            <div id="review1Content" class="content-section mb-4" style="display: none;">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h3 class="mb-0">Review 1 Criteria Analysis</h3>
                    </div>
                    <div class="card-body">
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <div class="chart-container">
                                            <canvas id="review1OverallScore"></canvas>
                                        </div>
                                        <h4 class="mt-3">Overall Score</h4>
                                        <p>Average score across all criteria</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="card">
                                    <div class="card-body">
                                        <h5>Criteria Breakdown</h5>
                                        <div class="row row-cols-2 row-cols-md-3 g-4" id="review1CriteriaGrid">
                                            <!-- Will be populated by JavaScript -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Review 2 Container -->
            <div id="review2Content" class="content-section mb-4" style="display: none;">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h3 class="mb-0">Review 2 Criteria Analysis</h3>
                    </div>
                    <div class="card-body">
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <div class="chart-container">
                                            <canvas id="review2OverallScore"></canvas>
                                        </div>
                                        <h4 class="mt-3">Overall Score</h4>
                                        <p>Average score across all criteria</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="card">
                                    <div class="card-body">
                                        <h5>Criteria Breakdown</h5>
                                        <div class="row row-cols-2 row-cols-md-3 g-4" id="review2CriteriaGrid">
                                            <!-- Will be populated by JavaScript -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Review 3 Container -->
            <div id="review3Content" class="content-section mb-4" style="display: none;">
                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h3 class="mb-0">Review 3 Criteria Analysis</h3>
                    </div>
                    <div class="card-body">
                        <div class="row mb-4">
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-body text-center">
                                        <div class="chart-container">
                                            <canvas id="review3OverallScore"></canvas>
                                        </div>
                                        <h4 class="mt-3">Overall Score</h4>
                                        <p>Average score across all criteria</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="card">
                                    <div class="card-body">
                                        <h5>Criteria Breakdown</h5>
                                        <div class="row row-cols-2 row-cols-md-3 g-4" id="review3CriteriaGrid">
                                            <!-- Will be populated by JavaScript -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- All Reviews Container -->
            <div id="allReviewsContent" class="content-section mb-4" style="display: none;">
                <div class="card">
                    <div class="card-header bg-dark text-white">
                        <h3 class="mb-0">Overall Reviews Analysis</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card">
                                    <div class="card-body">
                                        <h5>Criteria Performance Across Reviews</h5>
                                        <canvas id="allReviewsChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Outcome Analysis Container -->
            <div id="outcomeAnalysisContent" class="content-section mb-4" style="display: none;">
                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <h3 class="mb-0">Outcome Analysis for {{ selected_department }}</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="card">
                                    <div class="card-body">
                                        <h5>Project Outcomes Overview</h5>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="card mb-3">
                                                    <div class="card-body">
                                                        <h4 class="text-center mb-4">Outcome Statistics</h4>
                                                        <div class="row row-cols-2 g-4">
                                                            <div class="col mb-4">
                                                                <div class="text-center">
                                                                    <div class="chart-container" style="width: 150px; height: 120px; margin: 0 auto;">
                                                                        <canvas id="nationalConfMeter"></canvas>
                                                                    </div>
                                                                    <h6 class="mt-3">National Conferences</h6>
                                                                    <p class="mb-0">{{ projects_1 }}</p>
                                                                    <p class="text-muted">Percentage: {{ percentages.national_conf }}%</p>
                                                                </div>
                                                            </div>
                                                            <div class="col mb-4">
                                                                <div class="text-center">
                                                                    <div class="chart-container" style="width: 150px; height: 120px; margin: 0 auto;">
                                                                        <canvas id="internationalConfMeter"></canvas>
                                                                    </div>
                                                                    <h6 class="mt-3">International Conference</h6>
                                                                    <p class="mb-0">{{ projects_2 }}</p>
                                                                    <p class="text-muted">Percentage: {{ percentages.international_conf }}%</p>
                                                                </div>
                                                            </div>
                                                            <div class="col mb-4">
                                                                <div class="text-center">
                                                                    <div class="chart-container" style="width: 150px; height: 120px; margin: 0 auto;">
                                                                        <canvas id="scopusMeter"></canvas>
                                                                    </div>
                                                                    <h6 class="mt-3">Scopus</h6>
                                                                    <p class="mb-0">{{ projects_3 }}</p>
                                                                    <p class="text-muted">Percentage: {{ percentages.scopus }}%</p>
                                                                </div>
                                                            </div>
                                                            <div class="col mb-4">
                                                                <div class="text-center">
                                                                    <div class="chart-container" style="width: 150px; height: 120px; margin: 0 auto;">
                                                                        <canvas id="scieMeter"></canvas>
                                                                    </div>
                                                                    <h6 class="mt-3">SCIE</h6>
                                                                    <p class="mb-0">{{ projects_4 }}</p>
                                                                    <p class="text-muted">Percentage: {{ percentages.scie }}%</p>
                                                                </div>
                                                            </div>
                                                            <div class="col mb-4">
                                                                <div class="text-center">
                                                                    <div class="chart-container" style="width: 150px; height: 120px; margin: 0 auto;">
                                                                        <canvas id="sciMeter"></canvas>
                                                                    </div>
                                                                    <h6 class="mt-3">SCI</h6>
                                                                    <p class="mb-0">{{ projects_5 }}</p>
                                                                    <p class="text-muted">Percentage: {{ percentages.sci }}%</p>
                                                                </div>
                                                            </div>
                                                            <div class="col mb-4">
                                                                <div class="text-center">
                                                                    <div class="chart-container" style="width: 150px; height: 120px; margin: 0 auto;">
                                                                        <canvas id="ugcMeter"></canvas>
                                                                    </div>
                                                                    <h6 class="mt-3">UGC</h6>
                                                                    <p class="mb-0">{{ projects_6 }}</p>
                                                                    <p class="text-muted">Percentage: {{ percentages.ugc }}%</p>
                                                                </div>
                                                            </div>
                                                            <div class="col mb-4">
                                                                <div class="text-center">
                                                                    <div class="chart-container" style="width: 150px; height: 120px; margin: 0 auto;">
                                                                        <canvas id="othersMeter"></canvas>
                                                                    </div>
                                                                    <h6 class="mt-3">Others</h6>
                                                                    <p class="mb-0">{{ projects_7 }}</p>
                                                                    <p class="text-muted">Percentage: {{ percentages.others }}%</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="card mb-3">
                                                    <div class="card-body text-center">
                                                        <div class="chart-container" style="width: 100%; height: 400px; margin: 0 auto;">
                                                            <canvas id="outcomeDistribution"></canvas>
                                                        </div>
                                                        <h4 class="mt-3">Outcome Distribution</h4>
                                                        <p class="text-muted">Total Projects: {{ total_projects }}</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Sample data - Replace with actual data from your backend
    const criteriaNames = [
        "Problem Identification",
        "Literature Survey",
        "Project Planning",
        "Implementation Progress",
        "Results & Analysis",
        "Documentation",
        "Presentation Skills",
        "Innovation & Creativity",
        "Team Collaboration",
        "Overall Quality"
    ];

    const reviewData = {
        review1: {
            scores: [85, 72, 90, 65, 78, 88, 92, 70, 85, 80],
            color: '#007bff',
            gradient: {
                start: '#007bff',
                end: '#00c6ff'
            }
        },
        review2: {
            scores: [88, 75, 92, 70, 82, 90, 94, 75, 88, 85],
            color: '#28a745',
            gradient: {
                start: '#28a745',
                end: '#84fb95'
            }
        },
        review3: {
            scores: [90, 80, 95, 75, 85, 92, 96, 80, 90, 88],
            color: '#17a2b8',
            gradient: {
                start: '#17a2b8',
                end: '#89ffff'
            }
        }
    };

    function createDoughnutChart(canvasId, score, color, showLabel = false) {
        const ctx = document.getElementById(canvasId).getContext('2d');
        
        // Create gradient based on review color
        const gradient = ctx.createLinearGradient(0, 0, 0, 200);
        if (color === reviewData.review1.color) {
            gradient.addColorStop(0, reviewData.review1.gradient.start);
            gradient.addColorStop(1, reviewData.review1.gradient.end);
        } else if (color === reviewData.review2.color) {
            gradient.addColorStop(0, reviewData.review2.gradient.start);
            gradient.addColorStop(1, reviewData.review2.gradient.end);
        } else {
            gradient.addColorStop(0, reviewData.review3.gradient.start);
            gradient.addColorStop(1, reviewData.review3.gradient.end);
        }

        new Chart(ctx, {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [score, 100 - score],
                    backgroundColor: [gradient, '#eee'],
                    borderWidth: 0
                }]
            },
            options: {
                cutout: '75%',
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: { display: false },
                    tooltip: { enabled: false }
                }
            },
            plugins: [{
                id: 'centerText',
                afterDraw: (chart) => {
                    const ctx = chart.ctx;
                    const width = chart.width;
                    const height = chart.height;

                    ctx.restore();
                    ctx.font = 'bold 20px Arial';
                    ctx.textBaseline = 'middle';
                    ctx.textAlign = 'center';

                    const text = score + '%';
                    const textX = width / 2;
                    const textY = height / 2;

                    ctx.fillStyle = '#000';
                    ctx.fillText(text, textX, textY);
                    ctx.save();
                }
            }]
        });
    }

    function populateCriteriaGrid(reviewNumber, scores, color) {
        const grid = document.getElementById(`review${reviewNumber}CriteriaGrid`);
        grid.innerHTML = '';
        
        scores.forEach((score, index) => {
            const col = document.createElement('div');
            col.className = 'col mb-4';
            
            const card = document.createElement('div');
            card.className = 'card h-100';
            
            const cardBody = document.createElement('div');
            cardBody.className = 'card-body text-center';
            
            const canvasContainer = document.createElement('div');
            canvasContainer.style.position = 'relative';
            canvasContainer.style.width = '120px';
            canvasContainer.style.height = '120px';
            canvasContainer.style.margin = '0 auto';
            
            const canvas = document.createElement('canvas');
            canvas.id = `review${reviewNumber}Criteria${index}`;
            
            const title = document.createElement('h6');
            title.className = 'mt-3 mb-0';
            title.textContent = criteriaNames[index];
            
            canvasContainer.appendChild(canvas);
            cardBody.appendChild(canvasContainer);
            cardBody.appendChild(title);
            card.appendChild(cardBody);
            col.appendChild(card);
            grid.appendChild(col);
            
            // Create doughnut chart with percentage label
            createDoughnutChart(canvas.id, score, color, true);
        });
    }

    function createAllReviewsChart() {
        const ctx = document.getElementById('allReviewsChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: criteriaNames,
                datasets: [
                    {
                        label: 'Review 1',
                        data: reviewData.review1.scores,
                        backgroundColor: reviewData.review1.color,
                    },
                    {
                        label: 'Review 2',
                        data: reviewData.review2.scores,
                        backgroundColor: reviewData.review2.color,
                    },
                    {
                        label: 'Review 3',
                        data: reviewData.review3.scores,
                        backgroundColor: reviewData.review3.color,
                    }
                ]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 100
                    }
                }
            }
        });
    }

    function createHalfCircleMeter(canvasId, value, color) {
        const ctx = document.getElementById(canvasId).getContext('2d');
        const width = 150;
        const height = 120;
        
        // Set canvas dimensions
        ctx.canvas.width = width;
        ctx.canvas.height = height;
        
        // Clear the canvas
        ctx.clearRect(0, 0, width, height);
        
        // Calculate center and radius
        const centerX = width / 2;
        const centerY = height - 40;
        const radius = width / 2 - 15;
        
        // Draw the background arc
        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, Math.PI, 0);
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 10;
        ctx.stroke();
        
        // Draw the value arc
        const percentage = Math.min(value / 10, 1);
        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, Math.PI, Math.PI + (Math.PI * percentage));
        ctx.strokeStyle = color;
        ctx.lineWidth = 8;
        ctx.stroke();
        
        // Add the value text
        ctx.fillStyle = '#000';
        ctx.font = 'bold 20px Arial';
        ctx.textAlign = 'center';
        ctx.fillText(value, centerX, centerY - 20);
    }

    function showContent(contentId) {
        console.log('Showing content:', contentId); // Debug log
        
        // Hide all content sections
        document.querySelectorAll('.content-section').forEach(section => {
            section.style.display = 'none';
        });
        
        // Show the selected content section
        const selectedSection = document.getElementById(contentId + 'Content');
        if (selectedSection) {
            selectedSection.style.display = 'block';
            console.log('Section found:', contentId + 'Content'); // Debug log
        } else {
            console.error('Section not found:', contentId + 'Content'); // Debug log
        }

        // Initialize charts based on the selected section
        if (contentId === 'review1') {
            const avgScore = Math.round(reviewData.review1.scores.reduce((a, b) => a + b) / reviewData.review1.scores.length);
            createDoughnutChart('review1OverallScore', avgScore, reviewData.review1.color, true);
            populateCriteriaGrid(1, reviewData.review1.scores, reviewData.review1.color);
        } else if (contentId === 'review2') {
            const avgScore = Math.round(reviewData.review2.scores.reduce((a, b) => a + b) / reviewData.review2.scores.length);
            createDoughnutChart('review2OverallScore', avgScore, reviewData.review2.color, true);
            populateCriteriaGrid(2, reviewData.review2.scores, reviewData.review2.color);
        } else if (contentId === 'review3') {
            const avgScore = Math.round(reviewData.review3.scores.reduce((a, b) => a + b) / reviewData.review3.scores.length);
            createDoughnutChart('review3OverallScore', avgScore, reviewData.review3.color, true);
            populateCriteriaGrid(3, reviewData.review3.scores, reviewData.review3.color);
        } else if (contentId === 'allReviews') {
            createAllReviewsChart();
        } else if (contentId === 'outcomeAnalysis') {
            // Create outcome distribution chart
            const ctx = document.getElementById('outcomeDistribution').getContext('2d');
            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: [
                        'National Conferences',
                        'International Conference',
                        'Scopus',
                        'SCIE',
                        'SCI',
                        'UGC',
                        'Others'
                    ],
                    datasets: [{
                        data: [
                            {{ projects_1 }},
                            {{ projects_2 }},
                            {{ projects_3 }},
                            {{ projects_4 }},
                            {{ projects_5 }},
                            {{ projects_6 }},
                            {{ projects_7 }}
                        ],
                        backgroundColor: [
                            '#FF6384',
                            '#36A2EB',
                            '#FFCE56',
                            '#4BC0C0',
                            '#9966FF',
                            '#FF9F40',
                            '#FF6384'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });

            // Create half-circle meters for each outcome
            createHalfCircleMeter('nationalConfMeter', {{ projects_1 }}, '#FF6384');
            createHalfCircleMeter('internationalConfMeter', {{ projects_2 }}, '#36A2EB');
            createHalfCircleMeter('scopusMeter', {{ projects_3 }}, '#FFCE56');
            createHalfCircleMeter('scieMeter', {{ projects_4 }}, '#4BC0C0');
            createHalfCircleMeter('sciMeter', {{ projects_5 }}, '#9966FF');
            createHalfCircleMeter('ugcMeter', {{ projects_6 }}, '#FF9F40');
            createHalfCircleMeter('othersMeter', {{ projects_7 }}, '#FF6384');
        }
    }

    // Make sure the script runs after the DOM is fully loaded
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM loaded'); // Debug log
        showContent('review1'); // Show Review 1 by default
    });

    // Update table styles
    const tableStyles = `
        <style>
            .table td {
                vertical-align: middle;
            }
            .table td:last-child {
                width: 80px;
                text-align: center;
            }
        </style>
    `
</script>
</body>
</html>